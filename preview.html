<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Preview Test</title>
</head>
<body>
  <h2>ทดสอบส่งข้อมูลไป Google Apps Script</h2>
  <button id="sendBtn">ส่งข้อมูล</button>

  <script>
    document.getElementById("sendBtn").addEventListener("click", () => {
      // ✅ ข้อมูลทดสอบ
      const data = {
        empId: "1234",
        empName: "นายทดสอบ",
        position: "Programmer",
        department: "IT",
        leaveType: "Vacation",
        startDate: "2025-09-09T08:00:00",
        endDate: "2025-09-09T17:00:00",
        leaveDays: 1,
        reason: "ไปธุระ",
        hasDocument: "ไม่มี",
        signature: "" // ถ้ามี base64 ค่อยใส่
      };

      // ✅ ใส่ URL ของ Web App ที่ Deploy แล้ว (ต้องเป็น /exec)
      const url = "https://script.google.com/macros/s/AKfycbwviyKkV7geROoSiWGxPy0HtqFvjOtXF4SXR2SdXTPoGRDyrfwSIe0bxfelBmtYlfl4/exec";

      console.log("กำลังส่งไปที่:", url);
      console.log("Data ที่ส่ง:", data);

      fetch(url, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      })
      .then(res => {
        console.log("Response Status:", res.status);
        return res.text(); // ใช้ text() ก่อน กันกรณี response ไม่ใช่ JSON
      })
      .then(txt => {
        console.log("Response Raw:", txt);
        try {
          const json = JSON.parse(txt);
          console.log("Response JSON:", json);
        } catch (e) {
          console.warn("ไม่สามารถ parse JSON:", e);
        }
      })
      .catch(err => {
        console.error("Fetch Error:", err);
      });
    });
  </script>
</body>
</html>
