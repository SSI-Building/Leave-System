<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Preview Test</title>
</head>
<body>
  <h2>à¸—à¸”à¸ªà¸­à¸šà¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸› Google Apps Script</h2>
  <button id="sendBtn">à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥</button>

  <script>
    document.getElementById("sendBtn").addEventListener("click", () => {
      // âœ… à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸”à¸ªà¸­à¸š
      const data = {
        empId: "1234",
        empName: "à¸™à¸²à¸¢à¸—à¸”à¸ªà¸­à¸š",
        position: "Programmer",
        department: "IT",
        leaveType: "Vacation",
        startDate: "2025-09-09T08:00:00",
        endDate: "2025-09-09T17:00:00",
        leaveDays: 1,
        reason: "à¹„à¸›à¸˜à¸¸à¸£à¸°",
        hasDocument: "à¹„à¸¡à¹ˆà¸¡à¸µ",
        signature: "" // à¸–à¹‰à¸²à¸¡à¸µ base64 à¸„à¹ˆà¸­à¸¢à¹ƒà¸ªà¹ˆ
      };

      // âœ… à¹ƒà¸ªà¹ˆ URL à¸‚à¸­à¸‡ Web App à¸—à¸µà¹ˆ Deploy à¹à¸¥à¹‰à¸§ (à¸•à¹‰à¸­à¸‡à¹€à¸›à¹‡à¸™ /exec)
      const url = "https://script.google.com/macros/s/AKfycbwviyKkV7geROoSiWGxPy0HtqFvjOtXF4SXR2SdXTPoGRDyrfwSIe0bxfelBmtYlfl4/exec";

      console.log("à¸à¸³à¸¥à¸±à¸‡à¸ªà¹ˆà¸‡à¹„à¸›à¸—à¸µà¹ˆ:", url);
      console.log("Data à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡:", data);

      fetch(url, {
        method: "POST",
        mode: "no-cors",   // ðŸ‘ˆ à¹ƒà¸ªà¹ˆà¸•à¸£à¸‡à¸™à¸µà¹‰
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      })
      .then(res => {
        // âš ï¸ no-cors à¸ˆà¸°à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸­à¹ˆà¸²à¸™ response à¹„à¸”à¹‰
        console.log("à¸ªà¹ˆà¸‡à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢ âœ… (à¹à¸•à¹ˆà¸ˆà¸°à¸­à¹ˆà¸²à¸™ response à¹„à¸¡à¹ˆà¹„à¸”à¹‰)");
      })
      .catch(err => {
        console.error("Fetch Error:", err);
      });
    });
  </script>
</body>
</html>
