<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard - All History</title>
  <style>
    body { font-family: sans-serif; margin: 20px; background: #f8f9fa; }
    h1 { text-align: center; margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; background: #fff; }
    th, td { border: 1px solid #ddd; padding: 6px; font-size: 13px; text-align: center; }
    th { background: #007bff; color: white; }
    tr:nth-child(even) { background: #f2f2f2; }
  </style>
</head>
<body>
  <h1>ðŸ“Š Admin Dashboard - All History</h1>
  <table id="dataTable">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbx2Y2ChK_CSCUr5xOe5TX0dxSIbOjtnFNWCwqUFRroi2OtLQgDRfxGX41k2O2DHm1Mt/exec"; // à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸›à¹‡à¸™ URL à¸ˆà¸£à¸´à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“

    async function fetchAllHistory() {
      const res = await fetch(`${WEBAPP_URL}?action=getAllHistory`);
      const data = await res.json();
      renderTable(data);
    }

    function renderTable(data) {
      const tableHead = document.querySelector("#dataTable thead");
      const tableBody = document.querySelector("#dataTable tbody");
      tableHead.innerHTML = "";
      tableBody.innerHTML = "";

      if (!data || data.length === 0) {
        tableBody.innerHTML = "<tr><td colspan='19'>à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥</td></tr>";
        return;
      }

      // Header
      const headerRow = document.createElement("tr");
      data[0].forEach(h => {
        const th = document.createElement("th");
        th.textContent = h;
        headerRow.appendChild(th);
      });
      tableHead.appendChild(headerRow);

      // Rows
      for (let i = 1; i < data.length; i++) {
        const row = data[i];
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        tableBody.appendChild(tr);
      }
    }

    window.onload = fetchAllHistory;
  </script>
</body>
</html>
