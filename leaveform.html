<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
/* --- (CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) --- */
</style>
</head>
<body>
<div class="container">
  <h2>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå <i class="fas fa-file-contract"></i></h2>

  <section class="form-section">
    <h3 class="form-section-title"><i class="fas fa-user-circle"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
    <div class="form-grid">
      <div class="form-group">
        <label for="empName">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
        <input type="text" id="empName" readonly value="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
      </div>
      <div class="form-group">
        <label for="empId">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
        <input type="text" id="empId" readonly value="EMP001">
      </div>
      <div class="form-group">
        <label for="position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
        <input type="text" id="position" readonly value="‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">
      </div>
      <div class="form-group">
        <label for="department">‡∏ù‡πà‡∏≤‡∏¢</label>
        <input type="text" id="department" readonly value="BUS">
      </div>
    </div>
  </section>

  <section class="form-section">
    <h3 class="form-section-title"><i class="fas fa-file-alt"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤</h3>
    <div class="form-group">
      <label for="leaveType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label>
      <select id="leaveType">
        <option value="AL">‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</option>
        <option value="SL">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</option>
        <option value="BL">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</option>
      </select>
    </div>
    <div class="form-group">
      <label for="reason">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label>
      <textarea id="reason" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•"></textarea>
    </div>
    <div class="form-group">
      <label>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</label>
      <div class="radio-group">
        <label><input type="radio" name="hasDocument" value="‡∏°‡∏µ"> ‡∏°‡∏µ</label>
        <label><input type="radio" name="hasDocument" value="‡πÑ‡∏°‡πà‡∏°‡∏µ"> ‡πÑ‡∏°‡πà‡∏°‡∏µ</label>
      </div>
    </div>
  </section>

  <section class="form-section">
    <h3 class="form-section-title"><i class="fas fa-clock"></i> ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏•‡∏≤</h3>
    <div class="date-group">
      <div class="form-group">
        <label for="startDate">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="datetime-local" id="startDate">
      </div>
      <div class="form-group">
        <label for="endDate">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="datetime-local" id="endDate">
      </div>
      <div id="leaveDaysDisplay"></div>
    </div>
  </section>
  
  <section class="form-section">
    <h3 class="form-section-title"><i class="fas fa-signature"></i> ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå</h3>
    <div class="form-group">
      <canvas id="signaturePad" class="signature-pad"></canvas>
      <button type="button" onclick="clearSignature()" class="btn-clear"><i class="fas fa-eraser"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</button>
    </div>
  </section>

  <div class="buttons">
    <button class="btn" id="submitBtn"><i class="fas fa-paper-plane"></i> ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>
    <button class="btn btn-secondary" onclick="window.location.href='Dashboard.html'"><i class="fas fa-arrow-left"></i> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<script>
/* ----------------- JavaScript ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ----------------- */

// (JS ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ... ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≠‡∏Å)

/* ----------------- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏õ Apps Script ----------------- */
document.getElementById("submitBtn").addEventListener("click", () => {
    // (‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á, ‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠, ‡∏ß‡∏±‡∏ô‡∏•‡∏≤ ‡∏Ø‡∏•‡∏Ø ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)

    // üëá ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script
    const payload = {
        empId: document.getElementById("empId").value,
        empName: document.getElementById("empName").value,
        position: document.getElementById("position").value,
        department: document.getElementById("department").value,
        leaveType: document.getElementById("leaveType").value,
        reason: document.getElementById("reason").value,
        startDate: document.getElementById("startDate").value,
        endDate: document.getElementById("endDate").value,
        leaveDays: parseFloat(document.getElementById("leaveDaysDisplay").innerText.replace(/\D/g, "")) || 0,
        hasDocument: document.querySelector("input[name='hasDocument']:checked")?.value || "",
        signature: signaturePad.toDataURL() // Base64
    };

    fetch("https://script.google.com/macros/s/AKfycbxbsO6aawtTcBQ1FSVCePsVAL4AZAi7BErDF_W89rs4pNLEhTBc2BdKb025kz3gPczM/exec", {
        method: "POST",
        body: JSON.stringify(payload),
        headers: {
            "Content-Type": "application/json"
        }
    })
    .then(res => res.json())
    .then(result => {
        if (result.status === "success") {
            alert("‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
        } else {
            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + result.message);
        }
    })
    .catch(err => {
        alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ: " + err);
    });
});
</script>
</body>
</html>
