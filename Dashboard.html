<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
:root {
  --primary-color-start: #1994b6;
  --primary-color-end: #36a761;
  --text-color: #333;
  --light-text-color: #666;
  --background-color: #f0f2f5;
  --card-background: #ffffff;
  --shadow-light: 0 4px 15px rgba(0,0,0,0.08);
  --border-color: #e0e0e0;
}

/* ===== Theme Variants ===== */
body.theme-orange-purple {
  --primary-color-start: #ff7e5f;
  --primary-color-end: #6a11cb;
}
body.theme-blue-violet {
  --primary-color-start: #36d1dc;
  --primary-color-end: #5b86e5;
}
body.theme-pink-purple {
  --primary-color-start: #ff758c;
  --primary-color-end: #8e44ad;
}
body.theme-green-gold {
  --primary-color-start: #11998e;
  --primary-color-end: #fbc531;
}
body.theme-red-orange {
  --primary-color-start: #f12711;
  --primary-color-end: #f5af19;
}
body.theme-teal-navy {
  --primary-color-start: #2b5876;
  --primary-color-end: #4e4376;
}
body.theme-monochrome {
  --primary-color-start: #555;
  --primary-color-end: #999;
}
body.theme-dark {
  --primary-color-start: #141E30;
  --primary-color-end: #243B55;
  --text-color: #eee;
  --light-text-color: #bbb;
  --background-color: #181818;
  --card-background: #242424;
  --border-color: #444;
}

/* ===== Base Styles ===== */
body {
  font-family: 'Prompt', sans-serif;
  background: var(--background-color);
  margin:0;
  padding:20px;
  color:var(--text-color);
  transition: all 0.3s ease;
}
.container { max-width: 600px; margin:auto; position:relative; }
.header {
  display:flex; align-items:center; gap:15px; margin-bottom:30px;
  background: linear-gradient(135deg, var(--primary-color-start), var(--primary-color-end));
  padding:25px; border-radius:15px; color:#fff;
  box-shadow:var(--shadow-light); position:relative;
}
.profile-pic {
  width:60px; height:60px; border-radius:50%;
  background:rgba(255,255,255,0.2); object-fit:cover;
  border:3px solid rgba(255,255,255,0.5);
}
.greeting { font-size:20px; font-weight:600; }
.motivation { font-size:14px; color:rgba(255,255,255,0.8); margin-top:5px; }
.settings-icon { position:absolute; top:25px; right:25px; font-size:24px; color:#fff; cursor:pointer; }

/* Theme Selector */
.theme-selector {
  position:absolute; top:60px; right:25px;
  background:var(--card-background);
  padding:10px; border-radius:8px;
  box-shadow:var(--shadow-light);
  display:none; flex-direction:column; gap:10px; z-index:10;
}
.theme-selector.active { display:flex; }
.theme-option {
  padding:8px 12px; border-radius:6px;
  cursor:pointer; font-size:14px; font-weight:500;
  border:1px solid var(--border-color); text-align:center;
  transition: all 0.3s ease;
}
.theme-option:hover { background: var(--background-color); }
.theme-save-btn {
  width:100%; padding:10px; margin-top:10px;
  border:none; border-radius:6px;
  background: linear-gradient(45deg, var(--primary-color-start), var(--primary-color-end));
  color:#fff; font-weight:600; cursor:pointer;
  transition: all 0.3s ease;
  box-shadow:0 2px 4px rgba(0,0,0,0.1);
}
.theme-save-btn:hover { opacity:0.9; transform:translateY(-1px); }

/* Tabs */
.tabs-container { background: var(--card-background); padding:10px; border-radius:12px; box-shadow: var(--shadow-light); margin-bottom:20px; }
.tabs { display:flex; border-radius:8px; }
.tab {
  flex:1; text-align:center; padding:12px 0; cursor:pointer;
  font-weight:500; color: var(--light-text-color); transition: all 0.3s ease;
}
.tab.active {
  background: linear-gradient(135deg, var(--primary-color-start), var(--primary-color-end));
  color:#fff; font-weight:600; border-radius:8px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
}
.tab-content { display:none; padding-top:20px; }
.tab-content.active { display:block; }

/* Tables */
.table-container { background: var(--card-background); border-radius:12px; overflow:hidden; box-shadow: var(--shadow-light); margin-bottom:20px; }
table { width:100%; border-collapse:collapse; }
th, td {
  padding:15px; text-align:center; font-size:15px; border-bottom:1px solid var(--border-color);
}
th { background: var(--background-color); font-weight:600; color: var(--text-color); }
tr:last-child td { border-bottom:none; }

/* Buttons */
.buttons { display:flex; gap:15px; margin-top:20px; }
.btn {
  flex:1; padding:15px; border:none; border-radius:10px;
  font-weight:600; cursor:pointer; font-size:16px;
  display:flex; align-items:center; justify-content:center; gap:8px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
  color:#fff; background: linear-gradient(45deg, var(--primary-color-start), var(--primary-color-end));
  transition: all 0.3s ease;
}
.btn:hover { box-shadow:0 6px 12px rgba(0,0,0,0.15); transform:translateY(-2px); }
</style>

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
const liffId = "2007956727-6V7DrnMD";
const GAS_URL = "https://script.google.com/macros/s/AKfycbypGDcud4AH8zMe4ySfQpcG8CxvFpLaD83E8C0t739Nh8A2bRTnr1-4UpxGwqSJ0FRu/exec";
let selectedTheme = null;
// ------------------ ข้อความกำลังใจ ------------------
const messages = [
  "ยินดีต้อนรับเข้าสู่ระบบ!", "ดีใจที่เจอคุณวันนี้!", "สู้ ๆ กับวันใหม่ครับ!",
  "ขอให้วันนี้เป็นวันที่ดี!", "ยิ้มรับความท้าทายวันนี้!", "ขอให้มีความสุขกับการทำงาน!",
  "มาสำรวจสิทธิ์ลาของคุณกัน!", "วันนี้ก็ทำได้ดีแน่นอนครับ!", "เริ่มต้นวันใหม่ด้วยพลังบวกกันเถอะ!",
  "ไม่ว่าอะไรเกิดขึ้น คุณก็เอาอยู่!", "ยินดีที่ได้เจอกันอีกครั้งนะครับ!", "ขอบคุณที่ตั้งใจทำงานเสมอ!",
  "มาลุยงานกันอย่างเต็มที่เลยครับ!", "พักบ้างก็ได้นะ แต่ห้ามยอมแพ้!", "เชื่อมั่นในตัวเอง แล้วก้าวต่อไปครับ!",
  "วันนี้อาจเจอความท้าทาย แต่คุณเก่งพอ!", "ขอให้วันนี้มีรอยยิ้มเยอะ ๆ นะครับ!"
];

async function loadDashboard() {
  await liff.init({ liffId });
  if(!liff.isLoggedIn()){ liff.login(); return; }

  const profile = await liff.getProfile();
  const userId = profile.userId;
  document.getElementById("profilePic").src = profile.pictureUrl;

    // สุ่มข้อความกำลังใจ
  const randomMessage = messages[Math.floor(Math.random() * messages.length)];
  document.getElementById("motivation").textContent = randomMessage;

  fetch(`${GAS_URL}?action=getBalance&userId=${userId}`)
    .then(res=>res.json())
    .then(data=>{
      if(data.error){ alert(data.error); return; }
      document.getElementById("empName").textContent = data.set1[1];
      document.getElementById("remainTable").innerHTML = `
        <tr><th>ประเภทการลา</th><th>จำนวนวัน</th></tr>
        <tr><td>ลาพักร้อน</td><td>${data.set1[3]}</td></tr>
        <tr><td>ลาป่วย</td><td>${data.set1[4]}</td></tr>
        <tr><td>ลากิจ</td><td>${data.set1[5]}</td></tr>`;
      document.getElementById("usedTable").innerHTML = `
        <tr><th>ประเภทการลา</th><th>จำนวนวัน</th></tr>
        <tr><td>ลาพักร้อน</td><td>${data.set2[3]}</td></tr>
        <tr><td>ลาป่วย</td><td>${data.set2[4]}</td></tr>
        <tr><td>ลากิจ</td><td>${data.set2[5]}</td></tr>
        <tr><td>ขาดงานสะสม</td><td>${data.set2[6]}</td></tr>`;
    })
    .catch(err=>console.error(err));
}

document.addEventListener("DOMContentLoaded", ()=>{
  loadDashboard();

  // โหลดธีมที่บันทึกไว้
  const savedTheme = localStorage.getItem('theme');
  if(savedTheme && savedTheme !== 'default'){
    document.body.classList.add('theme-'+savedTheme);
    selectedTheme = savedTheme;
  }

  // เปิดปิด Theme Selector
  document.getElementById('settingsIcon').addEventListener('click', ()=>{
    document.getElementById('themeSelector').classList.toggle('active');
  });

  // เลือกธีม
  document.querySelectorAll('.theme-option').forEach(option=>{
    option.addEventListener('click', function(){
      selectedTheme = this.getAttribute('data-theme');
      document.body.className = ''; // ล้างคลาสก่อน
      if(selectedTheme !== 'default'){
        document.body.classList.add('theme-'+selectedTheme);
      }
    });
  });

  // บันทึกธีม
  document.getElementById('saveThemeBtn').addEventListener('click', ()=>{
    if(selectedTheme){
      localStorage.setItem('theme', selectedTheme);
      alert('บันทึกธีมเรียบร้อยแล้ว!');
      document.getElementById('themeSelector').classList.remove('active');
    } else {
      alert('กรุณาเลือกธีมก่อนบันทึก');
    }
  });
});

function openTab(evt, tabId){
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.querySelectorAll(".tab-content").forEach(c=>c.classList.remove("active"));
  evt.currentTarget.classList.add("active");
  document.getElementById(tabId).classList.add("active");
}
</script>
</head>
<body>
<div class="container">
  <div class="header">
    <img id="profilePic" class="profile-pic" src="" alt="Profile">
    <div>
      <div class="greeting">Hi, <span id="empName">Username</span></div>
      <div class="motivation" id="motivation"></div>
    </div>
    <i class="fas fa-cog settings-icon" id="settingsIcon"></i>
  </div>

  <div class="theme-selector" id="themeSelector">
    <div class="theme-option" data-theme="default">Default color (Blue-Green)</div>
    <div class="theme-option" data-theme="orange-purple">Orange-Purple</div>
    <div class="theme-option" data-theme="blue-violet">Blue-Purple</div>
    <div class="theme-option" data-theme="pink-purple">Pink-Purple</div>
    <div class="theme-option" data-theme="green-gold">Green-Gold</div>
    <div class="theme-option" data-theme="red-orange">Red-Orange</div>
    <div class="theme-option" data-theme="teal-navy">Teal-Navy</div>
    <div class="theme-option" data-theme="monochrome">Monochrome</div>
    <div class="theme-option" data-theme="dark">Dark Mode</div>
    <button id="saveThemeBtn" class="theme-save-btn">Save Theme</button>
  </div>

  <div class="tabs-container">
    <div class="tabs">
      <div class="tab active" onclick="openTab(event,'remain')">สิทธิลาคงเหลือ</div>
      <div class="tab" onclick="openTab(event,'used')">สิทธิลาที่ใช้</div>
    </div>
  </div>

  <div class="table-container">
    <div id="remain" class="tab-content active"><table id="remainTable"></table></div>
    <div id="used" class="tab-content"><table id="usedTable"></table></div>
  </div>

  <div class="buttons">
    <button class="btn" onclick="window.location.href='leaveform.html'">
      <i class="fas fa-calendar-plus"></i> ลาออนไลน์
    </button>
    <button class="btn"><i class="fas fa-clock"></i> ตรวจสอบสถานะ</button>
  </div>
</div>
</body>
</html>
