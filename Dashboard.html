<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
  /* --- ‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏ò‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡∏°‡∏≤ --- */
  :root { --primary-color-start: #1994b6; --primary-color-end: #36a761; --text-color: #333; --light-text-color: #666; --background-color: #f0f2f5; --card-background: #ffffff; --shadow-light: 0 4px 15px rgba(0,0,0,0.08); --border-color: #e0e0e0; }
  body { font-family: 'Prompt', sans-serif; background: var(--background-color); margin:0; padding:20px; color:var(--text-color); transition: all 0.3s ease; }
  .container { max-width: 600px; margin:auto; position:relative; }
  .header { display:flex; align-items:center; gap:15px; margin-bottom:30px; background: linear-gradient(135deg, var(--primary-color-start), var(--primary-color-end)); padding:25px; border-radius:15px; color:#fff; box-shadow:var(--shadow-light); }
  .profile-pic { width:60px; height:60px; border-radius:50%; background:rgba(255,255,255,0.2); object-fit:cover; border:3px solid rgba(255,255,255,0.5); }
  .greeting { font-size:20px; font-weight:600; }
  .motivation { font-size:14px; color:rgba(255,255,255,0.8); margin-top:5px; }
  .tabs-container { background: var(--card-background); padding:10px; border-radius:12px; box-shadow: var(--shadow-light); margin-bottom:20px; }
  .tabs { display:flex; border-radius:8px; }
  .tab { flex:1; text-align:center; padding:12px 0; cursor:pointer; font-weight:500; color: var(--light-text-color); transition: all 0.3s ease; }
  .tab.active { background: linear-gradient(135deg, var(--primary-color-start), var(--primary-color-end)); color:#fff; font-weight:600; border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);}
  .tab-content { display:none; padding-top:20px; }
  .tab-content.active { display:block; }
  .table-container { background: var(--card-background); border-radius:12px; overflow:hidden; box-shadow: var(--shadow-light); margin-bottom:20px; }
  table { width:100%; border-collapse:collapse; }
  th, td { padding:15px; text-align:center; font-size:15px; border-bottom:1px solid var(--border-color); }
  th { background: var(--background-color); font-weight:600; color: var(--text-color); }
  tr:last-child td { border-bottom:none; }
</style>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
const liffId = "2007956727-6V7DrnMD"; // ‡πÉ‡∏™‡πà LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const GAS_URL = "https://script.google.com/macros/s/AKfycbypGDcud4AH8zMe4ySfQpcG8CxvFpLaD83E8C0t739Nh8A2bRTnr1-4UpxGwqSJ0FRu/exec";

async function loadDashboard() {
  await liff.init({ liffId });
  if (!liff.isLoggedIn()) { liff.login(); return; }

  const profile = await liff.getProfile();
  const userId = profile.userId;
  document.getElementById("profilePic").src = profile.pictureUrl;

  fetch(`${GAS_URL}?action=getBalance&userId=${userId}`)
    .then(res => res.json())
    .then(data => {
      if (data.error) { alert(data.error); return; }

      // ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
      document.getElementById("empName").textContent = data.set1[1];

      // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏•‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Balance)
      const remainTable = document.getElementById("remainTable");
      remainTable.innerHTML = `
        <tr><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</th></tr>
        <tr><td>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</td><td>${data.set1[3]}</td></tr>
        <tr><td>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</td><td>${data.set1[4]}</td></tr>
        <tr><td>‡∏•‡∏≤‡∏Å‡∏¥‡∏à</td><td>${data.set1[5]}</td></tr>
      `;

      // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (Records)
      const usedTable = document.getElementById("usedTable");
      usedTable.innerHTML = `
        <tr><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</th></tr>
        <tr><td>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</td><td>${data.set2[3]}</td></tr>
        <tr><td>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</td><td>${data.set2[4]}</td></tr>
        <tr><td>‡∏•‡∏≤‡∏Å‡∏¥‡∏à</td><td>${data.set2[5]}</td></tr>
        <tr><td>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°</td><td>${data.set2[6]}</td></tr>
      `;
    })
    .catch(err => console.error(err));
}

document.addEventListener("DOMContentLoaded", loadDashboard);

function openTab(evt, tabId) {
  document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
  document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
  evt.currentTarget.classList.add("active");
  document.getElementById(tabId).classList.add("active");
}
</script>
</head>
<body>
<div class="container">
  <div class="header">
    <img id="profilePic" class="profile-pic" src="" alt="Profile">
    <div>
      <div class="greeting">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, <span id="empName">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</span> üëã</div>
      <div class="motivation">‡∏û‡∏±‡∏Å‡∏ö‡πâ‡∏≤‡∏á‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ üí™</div>
    </div>
  </div>

  <div class="tabs-container">
    <div class="tabs">
      <div class="tab active" onclick="openTab(event,'remain')">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏•‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
      <div class="tab" onclick="openTab(event,'used')">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</div>
    </div>
  </div>

  <div class="table-container">
    <div id="remain" class="tab-content active">
      <table id="remainTable"></table>
    </div>
    <div id="used" class="tab-content">
      <table id="usedTable"></table>
    </div>
  </div>
</div>
</body>
</html>
